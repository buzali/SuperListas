/*********************************************************************
 *
 *                  LCD.c
 * 
*********************************************************************/

#include "HardwareProfile.h"
#include "Dogm/utility/dogm128.h"
#include <libpic30.h>
#include "LCD.h"
#include <stdlib.h>

//SuperListas Logo
const unsigned char logo_win [] = {
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x07, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x3F, 0xE0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x38, 0x00, 0xE0, 0x00, 0x04, 0x00, 0x00, 0x00,
0x7F, 0xF0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x38, 0x00, 0xE0, 0x00, 0x1C, 0x00, 0x00, 0x00,
0x78, 0xF0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x38, 0x00, 0x00, 0x00, 0x1C, 0x00, 0x00, 0x00,
0x70, 0x78, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x38, 0x00, 0x00, 0x00, 0x1C, 0x00, 0x00, 0x00,
0x70, 0x00, 0xE1, 0xC3, 0x3E, 0x03, 0xE0, 0x6F, 0x38, 0x00, 0xE1, 0xFC, 0x7F, 0x0F, 0xE0, 0xFE,
0x7C, 0x00, 0xE1, 0xC3, 0xFF, 0x0F, 0xF0, 0x7F, 0x38, 0x00, 0xE3, 0xFE, 0x7F, 0x1F, 0xF1, 0xFF,
0x7F, 0xC0, 0xE1, 0xC3, 0xEF, 0x0F, 0x78, 0x7E, 0x38, 0x00, 0xE3, 0x8E, 0x3F, 0x3C, 0xF1, 0xC7,
0x1F, 0xE0, 0xE1, 0xC3, 0x87, 0x9E, 0x38, 0x70, 0x38, 0x00, 0xE3, 0x80, 0x1C, 0x08, 0x71, 0xC0,
0x07, 0xF0, 0xE1, 0xC3, 0x83, 0x9C, 0x1C, 0x70, 0x38, 0x00, 0xE3, 0xF0, 0x1C, 0x00, 0xF1, 0xF8,
0x00, 0xF8, 0xE1, 0xC3, 0x83, 0x9F, 0xFC, 0x70, 0x38, 0x00, 0xE3, 0xFC, 0x1C, 0x0F, 0xF1, 0xFE,
0x60, 0x38, 0xE1, 0xC3, 0x83, 0x9F, 0xFC, 0x70, 0x38, 0x00, 0xE0, 0xFF, 0x1C, 0x1F, 0x70, 0x7F,
0xE0, 0x38, 0xE1, 0xC3, 0x83, 0x9C, 0x00, 0x70, 0x38, 0x00, 0xE0, 0x1F, 0x1C, 0x3C, 0x70, 0x0F,
0xF0, 0x78, 0xE1, 0xC3, 0x87, 0x9E, 0x30, 0x70, 0x38, 0x00, 0xE3, 0x07, 0x1C, 0x38, 0x71, 0x83,
0x7F, 0xF8, 0xF3, 0xC3, 0xCF, 0x0F, 0x38, 0x70, 0x3F, 0xF8, 0xE7, 0x8F, 0x1F, 0x3C, 0xF3, 0xC7,
0x3F, 0xF0, 0xFF, 0xC3, 0xFF, 0x0F, 0xF8, 0x70, 0x3F, 0xF8, 0xE3, 0xFE, 0x1F, 0x3F, 0xF9, 0xFF,
0x1F, 0xC0, 0x7C, 0xC3, 0xBE, 0x07, 0xE0, 0x70, 0x3F, 0xF8, 0xE1, 0xFC, 0x0F, 0x1F, 0x38, 0xFE,
0x00, 0x00, 0x00, 0x03, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x03, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x03, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x03, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0C, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0E, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x80, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x80, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0xFF, 0xFF, 0xFF, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0xFF, 0xFF, 0xFF, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xCC, 0x66, 0x62, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xFF, 0xFF, 0xFE, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xFF, 0xFF, 0xFE, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xCC, 0x66, 0x66, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x7F, 0xFF, 0xFE, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x7F, 0xFF, 0xFC, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x66, 0x66, 0xCC, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x7F, 0xFF, 0xFC, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x36, 0xEF, 0xFC, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x36, 0x6C, 0xD8, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x3F, 0xFF, 0xF8, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x30, 0x00, 0x70, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x30, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x18, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x1F, 0xFF, 0xE0, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0F, 0xFF, 0xE0, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x38, 0x00, 0x30, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x78, 0x00, 0x78, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x6C, 0x00, 0xD8, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x78, 0x00, 0xF8, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x30, 0x00, 0x70, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
};


#define width       128
#define c_width     6
#define c_height    13
#define lines       5


//Prints SuperListas Logo 
void LCD_printLogo(void)
{
      int i=0;
  int a = 1000;
      dog_StartPage();
  do
  {
    dog_SetBitmap(i,63,logo_win,127,63);
  } while( dog_NextPage() );
  __delay_ms(50);

}

//Initializes LCD Display
void LCD_init(void)
{
    dog_InitA0CS(LCD_A0_O, LCD_CS_O);
}




//Print string s, split in multiple lines if necessary
void LCD_printStr(const char *s)
{
    char primera[lines][22] = {'\0'};
    int fila = 0;
    char delim[5] = ", .";
    //Divide s en diferentes filas y las pone en el array de chars
    char *word = strtok(s, delim);
    while (word != NULL)
        {
        if (!((strlen(primera[fila]) + strlen(word)) < width/c_width))
            fila ++;
        if (fila >lines - 1)
            break;
        strcat(primera[fila], word);
        strcat(primera[fila], " ");
            //primera[fila]
        word = strtok(NULL, delim);
    }
    int i;
    i=0;

    //LCD_printMultilinea(primera, fila);
  dog_StartPage();
  do{
    for (i=0; i<=fila ;i++){
    dog_DrawStr(0, 52- c_height*i, font_6x13, primera[i]);
    }
  } while( dog_NextPage() );

}

